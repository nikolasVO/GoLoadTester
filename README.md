# GoLoadTester

**GoLoadTester** — это простой инструмент для нагрузочного тестирования веб-сайтов, написанный на Go. Программа использует горутины для параллельной отправки HTTP-запросов с заданной частотой (RPS) в течение определённого времени. В новой версии добавлены следующие возможности:

- **Бенчмарк**: функция, позволяющая определить максимально возможное количество запросов в секунду, которое может генерировать ПК.
- **Отправка запросов с разных локальных адресов**: поддержка задания одного или нескольких локальных IP-адресов для отправки запросов, что позволяет симулировать нагрузку с разных исходящих интерфейсов (используется схема round-robin).

> **Важно:**  
> Используйте данный инструмент **только** для тестирования тех ресурсов, на которые у вас есть разрешение. Несанкционированное тестирование может нарушать закон и привести к правовым последствиям.

## Описание

Проект позволяет:
- Проводить нагрузочное тестирование заданного URL.
- Настраивать количество запросов в секунду (RPS) вручную или определять его автоматически с помощью бенчмарка.
- Определять длительность теста.
- Отправлять запросы с указанных локальных IP-адресов (если необходимо).
- Логировать ответы сервера для дальнейшего анализа.

## Структура проекта
GoLoadTester/ 
    ├── go.mod // Файл модуля Go 
    ├── README.md // Описание проекта 
    ├── cmd/ 
        │ └── main.go // Точка входа в приложение, обработка аргументов командной строки и запуск теста 
    └── internal/ 
        └── loadtester/ 
            └── tester.go // Логика нагрузочного тестирования, функция бенчмарка и отправка запросов с локальных адресов

- **cmd/main.go:**  
  Обрабатывает аргументы командной строки, включая:
  - `-url` — URL для тестирования (обязательный параметр).
  - `-rps` — количество запросов в секунду. Если не указано, можно задать через бенчмарк.
  - `-duration` — длительность теста в секундах.
  - `-benchmark` — если установлен, перед тестированием выполняется бенчмарк для определения максимального RPS.
  - `-benchDuration` — длительность бенчмарка в секундах (по умолчанию 5 секунд).
  - `-localAddrs` — список локальных IP-адресов для отправки запросов (адреса задаются через запятую).

- **internal/loadtester/tester.go:**  
  Содержит основную логику:
  - `StartTest` — функция для проведения нагрузочного тестирования с заданными параметрами. Если указан список локальных адресов, запросы отправляются через соответствующих HTTP-клиентов по схеме round-robin.
  - `BenchmarkMaxRequests` — функция, выполняющая бенчмарк для определения максимально возможного RPS на выбранном URL. Поддерживает отправку запросов с разных локальных адресов.
  - `createHTTPClient` — вспомогательная функция для создания HTTP-клиента, привязанного к указанному локальному адресу.

## Требования

- [Go](https://golang.org/) версии 1.20 или выше.
- Корректная настройка кодировки (UTF-8) для отображения кириллических символов.
- Настроенные и доступные локальные IP-адреса (при использовании функции отправки запросов с разных адресов).

## Установка и запуск

**Запуск теста**

**С указанием RPS вручную**
    `go run cmd/main.go -url="http://example.com" -rps=20 -duration=30 -localAddrs="192.168.1.100,192.168.1.101"`

    -url — URL для тестирования.
    -rps — количество запросов в секунду.
    -duration — длительность теста в секундах.
    -localAddrs — список локальных IP-адресов для отправки запросов (опционально).

**С использованием бенчмарка для определения RPS:**
    `go run cmd/main.go -url="http://example.com" -duration=30 -benchmark=true -benchDuration=5 -localAddrs="192.168.1.100,192.168.1.101"`
    
    -benchmark — включает режим бенчмарка, который определит максимально возможный RPS.
    -benchDuration — задаёт длительность бенчмарка в секундах.
    После выполнения бенчмарка найденное значение RPS будет использовано для основного теста.



  
   
